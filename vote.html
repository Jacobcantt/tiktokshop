<!DOCTYPE html>
<html>
<head>
  <title>GÅ‚osowanie</title>
  <style>
    body { 
      font-family: Arial, sans-serif; 
      text-align: center; 
      padding: 20px;
      max-width: 600px;
      margin: 0 auto;
    }
    .container {
      background: #f9f9f9;
      padding: 30px;
      border-radius: 10px;
      margin-top: 50px;
    }
    button {
      background: #25F4EE;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 5px;
      cursor: pointer;
      margin-top: 15px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>GÅ‚osuj na @<span id="username"></span></h1>
    <p>Kliknij poniÅ¼ej, aby oddaÄ‡ gÅ‚os:</p>
    <button onclick="vote()">ğŸ—³ï¸ ZagÅ‚osuj</button>
    <p id="message"></p>
  </div>

  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
  <script src="firebase.js"></script>
  <script>
    // Pobierz nazwÄ™ uÅ¼ytkownika z URL
    const path = window.location.pathname; // np. "/@jacobcan"
    const username = path.split('@')[1];
    
    document.getElementById('username').textContent = username;

    function vote() {
      // Pobierz IP uÅ¼ytkownika (prosty sposÃ³b)
      fetch('https://api.ipify.org?format=json')
        .then(res => res.json())
        .then(data => {
          const ip = data.ip;
          
          // Zapisz gÅ‚os
          db.collection("votes").add({
            username: username,
            ip: ip,
            timestamp: firebase.firestore.FieldValue.serverTimestamp()
          }).then(() => {
            document.getElementById("message").innerHTML = `
              <span style="color: green;">âœ”ï¸ DziÄ™kujemy za gÅ‚os!</span>
              <p>MoÅ¼esz zamknÄ…Ä‡ tÄ™ stronÄ™</p>
            `;
          });
        });
    }
  </script>
</body>
</html>
